# plot the bismsb absoption spectrum of rat7.0.15

import numpy as np
import matplotlib.pyplot as plt





wavelth = np.array([200.0,204.0,208.0,212.0,216.0,220.0,224.0,228.0,232.0,236.0,240.0,244.0,248.0,252.0,256.0,260.0,264.0,268.0,272.0,276.0,280.0,284.0,288.0,292.0,296.0,300.0,304.0,308.0,312.0,316.0,320.0,324.0,328.0,332.0,336.0,340.0,344.0,348.0,352.0,356.0,360.0,364.0,368.0,372.0,376.0,380.0,384.0,388.0,392.0,396.0,400.0,404.0,408.0,412.0,416.0,420.0,424.0,428.0,432.0,436.0,440.0,444.0,448.0,452.0,456.0,460.0,464.0,468.0,472.0,476.0,480.0,484.0,488.0,492.0,496.0,500.0,504.0,508.0,512.0,516.0,520.0,524.0,528.0,532.0,536.0,540.0,544.0,548.0,552.0,556.0,560.0,564.0,568.0,572.0,576.0,580.0,584.0,588.0,592.0,596.0,800.0])
abs_lth = np.array([ 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 29.78, 35.27, 23.41, 19.86, 17.03, 14.86, 13.16, 11.78, 10.70, 9.89, 9.37, 9.17, 9.07, 9.09, 9.26, 9.57, 10.31, 11.61, 13.45, 15.96, 19.88, 26.75, 40.94, 74.71, 174.47, 498.86, 1772.19, 6422.35, 19889.38, 54673.77, 159669.88, 810517.44, 2459960.67, 1571299.73, 969517.70, 1479365.82, 1571299.73, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 919339.14, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31, 735471.31])
non_emit_lth = np.array([10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 132.2292327, 53.96587759, 149.4072875, 506.0983816, 1422.293253, 2703.80417, 3904.266215, 5322.329138, 6424.340253, 7425.991904, 10704.12536, 16033.01499, 20349.19724, 25976.70919, 34098.97724, 31495.49977, 42458.72468, 62085.33279, 63024.03142, 66117.0053, 77388.46742, 131732.7941, 167636.5533, 119041.6184, 112982.9625, 170350.7255, 346357.485, 190898.4157, 221956.236, 209449.2565, 871252.9842, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0, 10000000.0 ])

PPOemission_wvlth = np.array([200.0, 203.0, 205.0, 207.0, 209.0, 211.0, 213.0, 215.0, 217.0, 219.0, 221.0, 223.0, 225.0, 227.0, 229.0, 231.0, 233.0, 235.0, 237.0, 239.0, 241.0, 243.0, 245.0, 247.0, 249.0, 251.0, 253.0, 255.0, 257.0, 259.0, 261.0, 263.0, 265.0, 267.0, 269.0, 271.0, 273.0, 275.0, 277.0, 279.0, 281.0, 283.0, 285.0, 287.0, 289.0, 291.0, 293.0, 295.0, 297.0, 299.0, 301.0, 303.0, 305.0, 307.0, 309.0, 311.0, 313.0, 315.0, 317.0, 319.0, 321.0, 323.0, 325.0, 327.0, 329.0, 331.0, 333.0, 335.0, 337.0, 339.0, 341.0, 343.0, 345.0, 347.0, 349.0, 351.0, 353.0, 355.0, 357.0, 359.0, 361.0, 363.0, 365.0, 367.0, 369.0, 371.0, 373.0, 375.0, 377.0, 379.0, 381.0, 383.0, 385.0, 387.0, 389.0, 391.0, 393.0, 395.0, 397.0, 399.0, 401.0, 403.0, 405.0, 407.0, 409.0, 411.0, 413.0, 415.0, 417.0, 419.0, 421.0, 423.0, 425.0, 427.0, 429.0, 431.0, 433.0, 435.0, 437.0, 439.0, 441.0, 443.0, 445.0, 447.0, 449.0, 451.0, 453.0, 455.0, 457.0, 459.0, 461.0, 463.0, 465.0, 467.0, 469.0, 471.0, 473.0, 475.0, 477.0, 479.0, 481.0, 483.0, 485.0, 487.0, 489.0, 491.0, 493.0, 495.0, 497.0, 499.0, 501.0, 503.0, 505.0, 507.0, 509.0, 511.0, 513.0, 515.0, 517.0, 519.0, 521.0, 523.0, 525.0, 527.0, 529.0, 531.0, 533.0, 535.0, 537.0, 539.0, 541.0, 543.0, 545.0, 547.0, 549.0, 551.0, 553.0, 555.0, 557.0, 559.0, 561.0, 563.0, 565.0, 567.0, 569.0, 571.0, 573.0, 575.0, 577.0, 579.0, 581.0, 583.0, 585.0, 587.0, 589.0, 591.0, 593.0, 595.0, 597.0, 599.0, 800.0])
PPO_emission = np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.3325e-05, 2.5735e-05, 2.774e-05, 4.345e-05, 6.395e-05, 3.86e-05, 2.735e-05, 2.53e-05, 2.98e-05, 3.375e-05, 3.22e-05, 3.295e-05, 4.1e-05, 3.865e-05, 6.52e-05, 7.65e-05, 0.000134, 0.0022, 0.00484, 0.0088, 0.011, 0.01276, 0.01408, 0.0132, 0.01364, 0.01408, 0.01628, 0.01892, 0.02068, 0.02244, 0.02112, 0.0198, 0.01848, 0.01672, 0.01584, 0.01628, 0.01672, 0.01672, 0.01672, 0.01584, 0.01385, 0.0125, 0.0114, 0.0108, 0.0104, 0.01, 0.0095, 0.00905, 0.00855, 0.00785, 0.00725, 0.0065, 0.00595, 0.00535, 0.00485, 0.0046, 0.0042, 0.0039, 0.00365, 0.0034, 0.0031, 0.00295, 0.0027, 0.00235, 0.0022, 0.002, 0.0018, 0.00165, 0.00145, 0.00135, 0.00125, 0.00115, 0.001, 0.00095, 0.0009, 0.00075, 0.00075, 0.00065, 0.0006, 0.00055, 0.00045, 0.00045, 0.0004, 0.00035, 0.00035, 0.00025, 0.0003, 0.00025, 0.0002, 0.0002, 0.0002, 0.00015, 0.00015, 0.00015, 0.00015, 0.0001, 0.0001, 0.0001, 0.0001, 5e-05, 0.0001, 5e-05, 5e-05, 5e-05, 5e-05, 5e-05, 5e-05, 5e-05, 5e-05, 0.0, 5e-05, 5e-05, 0.0, 5e-05, 0.0, 5e-05, 0.0, 5e-05, 0.0, 0.0, 5e-05, 0.0, 0.0, 5e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ])

fig, ax = plt.subplots()



# 0.1 mg/L
abs_lth_low =  abs_lth/0.0154
# batch4 1.7mg
abs_lth_batch3 =  abs_lth/0.2618
# batch4 2.2mg
abs_lth_batch4 =  abs_lth/0.3388
# 50mg
abs_lth_50 =  abs_lth/7.7
#ax.plot(wavelth,PPO_emission,color='g',label="PPO Emission",linestyle='-')
ax.plot(wavelth,1./abs_lth_low,color='r',label="0.1mg/L")
ax.plot(wavelth,1./abs_lth_batch3,color='limegreen',label="1.7mg/L",linestyle='--')
ax.plot(wavelth,1./abs_lth_batch4,color='darkgreen',label="2.2mg/L",linestyle='--')
ax.plot(wavelth,1./abs_lth_50,color='b',label="50mg/L",linestyle='-.')
ax.plot(wavelth,1./non_emit_lth,color='black',label="non-emitted",linestyle='-.')

ax.legend()
ax.set_ylabel("1/Absorption Length [mm-1]")
plt.xlim(330, 430)
plt.ylim(0, 0.05)
fig.show()
input()